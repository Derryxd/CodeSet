1. 相关函数列表
1.1 建立新文件需要的变量         
    NF_CREATE           ! create netCDF dataset: enter define mode
       NF_DEF_DIM       ! define dimensions: from name and length
       NF_DEF_VAR       ! define variables: from name, type, dims
       NF_PUT_ATT       ! assign attribute values
    NF_ENDDEF           ! end definitions: leave define mode
       NF_PUT_VAR       ! provide values for variable
    NF_CLOSE            ! close: save new netCDF dataset

1.2 读取已知变量的旧文件
    NF_OPEN             ! open existing netCDF dataset
       NF_INQ_DIMID     ! get dimension IDs
       NF_INQ_VARID     ! get variable IDs
       NF_GET_ATT         ! get attribute values
       NF_GET_VAR        ! get values of variables
    NF_CLOSE            ! close netCDF dataset

1.3 读取未知变量的旧文件
    NF_OPEN                   ! open existing netCDF dataset
    NF_INQ                    ! find out what is in it
       NF_INQ_DIM             ! get dimension names, lengths
       NF_INQ_VAR             ! get variable names, types, shapes
       NF_INQ_ATTNAME      ! get attribute names
       NF_INQ_ATT          ! get attribute values
          NF_GET_ATT          ! get attribute values
       NF_GET_VAR             ! get values of variables
    NF_CLOSE                  ! close netCDF dataset

1.4 增加变量于旧文件中
    NF_OPEN             ! open existing netCDF dataset
    NF_REDEF            ! put it into define mode
      NF_DEF_DIM        ! define additional dimensions (if any)
      NF_DEF_VAR        ! define additional variables (if any)
      NF_PUT_ATT        ! define other attributes (if any)
    NF_ENDDEF           ! check definitions, leave define mode
      NF_PUT_VAR        ! provide new variable values
    NF_CLOSE            ! close netCDF dataset


2. 新建、打开、变量定义与关闭的 Fortran 程序

   由于使用的是 NetCDF 的参数，所以在每个 Fortran 程序之前均需要加入 『 include  'netcdf.inc'』这一行字。其中 “netcdf.inc”文件是安b完了 NetCDF 后所产生的文件，放置在『 /usr/local/include 』中！
     
2.1  NF_STRERROR(status)

    提供错误息！其中 status 为你程序绦写砦r所骰淼氖字，为整数！
    你可以写一个如下的副程序在每一个文件的Y尾，⒖梢宰你的程序具有出错误息的功能！
    -----
    subroutine  handle_err(status)
    integer  status
    if  (status  .NE.  nf_noerr) then
        print  *, nf_strerror(status)
        stop  'stopped'
    endif
    end
    -----
     
2.2  NF_INQ_LIBVERS()

    取得你的 NetCDF 程序版本，语法为：
    -----
    print  *, nf_inq_libvers()
    -----
     
2.3  NF_CREATE('filename', mode, ncid)     <==极重要，新增加文件用

    若你要建立一个名为 netcdf.ncf 的 NetCDF 文件，t你需要定义：文件号(ncid 为整数)和写入方式(mode，分为 nf_clobber, nf_noclobber, nf_share)。
    要注意的是，ncid 虽然只是个整数，但这个数字是由程序自动产生的，因此不可以O定为固定值！必为变量！
    -----
    integer  status, ncid
    status=nf_create('netcdf.ncf', nf_clobber, ncid)
    if (status  .NE.  nf_noerr)  call  handle_err(status)  <==若有错误刚绦 handle_err 这个子程序
    -----
     
2.4  NF_OPEN('filename', mode, ncid)   <==O重要，打开已有文件用

     打开一个已存在的文件！只有参数 mode 与 nf_create 不同，其主要分为 nf_write (可读写), nf_nowrite (只读，这是预设值), 及 nf_share 三个主要模式。
    -----
    status=nf_open('netcdf.ncf', nf_nowrite, ncid)
    -----
     
2.5 NF_REDEF(ncid)  <== 与 NF_OPEN 搭配使用

    当你要在一个已存在的文件中加入新变量r使用的！
    -----
    status=nf_redef(ncid)
    -----
     
2.5 NF_INQ(ncid, ndims, nvars, ngatts, unlimdimid)

    这个指令用在读取一个已存在文件的变量、层数、与f明n数目，所以然是与 nf_open 有关！基本上与读取n^为相关。
    -----
    status=nf_inq(ncid, ndims, nvars, ngatts, unlimdimid)
    write(*,*), ndims, nvars, ngatts, unlimdimid
    -----
     
2.6 NF_ENDDEF(ncid)

    这指令很重要，前面一章提^一个 fortran 程序可分为：变量定义区与资料^，而变量定义『一定』要关]之后才能进行Y料的入！因此定义完变量之后一定要有这个指令才行：
    -----
    status=nf_enddef(ncid)
    -----
     
2.7 NF_CLOSE(ncid)

    这个参数可下可不下，不^在你完成了一个 NetCDF 的工作之後，最後是下_这个指令，以使文件关闭！
    -----
    status=nf_close(ncid)
    -----


3. 定义dimention 指令

    在建立或打开了一个文件之後，再砭褪且宣告维数(dimention)啦！维数的宣告指令如下：
     
3.1 NF_DEF_DIM(ncid, name, len, dimid) <==与 nf_create 搭配

    在打开文件号为 ncid 的文件中，增加一个名为 name 的维，其长度为 len 个，并传回 ID 为 dimid，注意，这里的 dimid 也必是变量喔！
    若在第一号文件中增加一个 lat 的维，长度18个，并增加一个 rec 维，长数可无限增加，则分e可写成：
    -----
    status=nf_def_dim(ncid, 'lat', 18, latid)
    status=nf_def_dim(ncid, 'rec', nf_unlimited, recid)
    -----
     
3.2 NF_INQ_DIMID(ncid, name, dimid)

    主要与 nf_open 搭配，目的在取得已存在文件的维 ID，这是因为在每个维数中均有其代号（就是 ID），透^这个代号可以⑾喙氐奈募息读入！所以在读取一个已知文件r，通常需要这个指令喔！如下面的程序中若与上面一个指令相配合！
    -----
    status=nf_inq_dimid(ncid, 'lat', LATID)
    -----
     
3.3  NF_INQ_DIM(ncid, dimid, name, len)

    一定是与 nf_inq_dimid（） 配合使用的，由 nf_inq_dimid 取得维数的代号之後，以这个指令⒋宋数(dimention)的息取得之。与上面的程序相配合，由下面的指令可以lF name='lat', len=18。
    -----
    status=nf_inq_dim(ncid, LATID, name, len)
    -----
     
3.4  NF_RENAME_DIM(ncid, dimid, name)

    这是一个可以改变维名称的指令，与上面的程序相配合的，t可以 lat 改成 latitude 的维名Q：
    -----
    status=nf_rename_dim(ncid, LATID, 'latitude')
    -----


4. 建立和读取变量资料

 基本上变量的定义用 nf_def_xxx, 而变量的{查使用 nf_inq_xxx, 变量的写入使用 nf_put_xxx, 而变量的读取t使用 nf_get_xxx，以下分e介B之：
     
4.1  定义变量： NF_DEF_VAR(ncid, name, xtype, nvdims, vdims, varid)   

    name：变量名称；
    xtype：变量类型，分e是：nf_byte, nf_char, nf_short, nf_int, nf_float, nf_double 等六种；
    nvdims：变量的缺淞课多少；
    vdims：变量的函数相的维数ID；
    varid：变量ID。

     假设我要一个相κ度的变量，其根据经纬度及rg（三个缺淞浚，所以 vdims 就必与 经度、纬度、rg的ID相同啦！且其变量ID O为 VARID ，t可以写成：
    -----
    status=nf_creat('netcdf.ncf, nf_noclobber, ncid)
    status=nf_def_dim(ncid, 'lat', 5, LATID)
    status=nf_def_dim(ncid, 'lon', 10, LONID)
    status=nf_def_dim(ncid, 'time', nf_unlimited, TIMEID)
    integer  RHDIMS(3)
    RHDIMS(1) = LONID
    RHDIMS(2) = LATID
    RHDIMS(3) = TIMEID
    status=nf_def_var(ncid, 'rh', nf_double, 3, RHDIMS, RHID)
    -----
     
4.2  查看变量ID： NF_INQ_VARID(ncid, 'name', varid)    

    与 nf_inq_dimid 语法相似。在取得了变量的 ID 之後才可以读取变量的其他信息！
    -----
    status=nf_inq_varid(ncid, 'lat', LATID)
    print *, LATID  <== 可以列出纳细鲋噶钊〉玫谋淞看码！
    -----
     
4.3  NF_INQ_VAR(ncid, varid, 'name', xtype, ndims, dimids, natts)

    根据 ncid 与 varid （前一个指令得到的）筛鲑Y料，便可取得 xtype, ndims, dimids, natts 的信息！
    -----
    status=nf_inq_var(ncid, LATID, latname, lattype, nlat, latdims, latnatts)
    write(*,*), latname, lattype, nlat, latdims, latnatts
    -----
     
4.4  写入变量：NF_PUT_VAR1_type(ncid, varid, index(x), type_val)   

    ⒛愕摹阂还PY料』『写入』Y料Υ^！是很重要的一个指令！其中，type 为六NY料类型的名Q，分e为『TEXT, INT1, INT2, INT, REAL, DOUBLE』六N。至於 index t是一个列，指出变量要存的地方，下面的指令更重要喔！可以去看看！在这个指令的语法：若我要三个相κ度M入文件中，且三个相κ度都是 0.5 ，t：
    -----
    integet  RHINDX(3)
    data  RHINDX  /4, 3, 2/
    statuse=nf_put_var1_double(ncid, RHID, RHINDX, 0.5)
    -----
     
4.5   NF_PUT_VAR_type(ncid, varid, type_var(x))

    这个指令比的更常使用在一个新建立的文件中，因为他是『所有的Y料列均写入文件中』的一个指令！type 的类型与上个指令相同。假O我要写入一个三维列函数（相κ度），你可以这有矗
    -----
    double  rhvar(ilon, ilat, itime)
    do 10 ilon=1, lons
         do 10 ilat=1, lats
              do 10 itime=1, times
                   rhvar(ilon, ilat, itime)=0.5
    10 continue
    status=nf_put_var_double(ncid, RHID, rhvar)
    -----
     
4.6    NF_PUT_VARA_type(ncid, varid, start(x), count(x), type_var(x))

    这个指令在於写入一部分Y料M入一个 array 中。注意！这个 array 的维数要与已存在的文件相同，你可以与下一个指令相配合著看！这个指令比^常用在新增加或取代一部分Y料於一个已存在的文件中。其中，start(x)指开始写入的位置，count(x)t是写入的个数！与上一个指令的例相配合，我可以lF rhvar 为一个三维的列，所以 start 与 count 都需要入三个变量⑹加敫鍪值。若由第1个写起，共写了 lons, lats, times 个，t：
    -----
    integer  start(3), count(3)
    data  start  /1, 1, 1/
    data  count  /lons, lats, times/
    status=nf_put_vara_double(ncid, RHID, start, count, rhvar)
    -----
     
4.7     NF_PUT_VARS_type(ncid, varid, start(x), count(x), stride(x), type_var(x))

    配合上一个指令，这个指令H写入一个比原淼年列(array)要小的列中，更常用於取代一个已存在的文件中的Y料。例如上一个指令的例中 rhvar 为三维变量，我要改变其中筛鑫数，t可以写成：
    -----
    integer  start(2), count(2), stride(2)
    statuse=nf_put_vars_real(ncid, RHID, start, count, stride, rh)
    -----
     
4.8    NF_PUT_VARM_type(ncid, varid, start(x), count(x), staride(x), imap(x), type_var(x))

    这个指令我看不太懂，因为 map 的定x我并不明t之故！不^，基本上Υ姹淞康姆椒ㄒ nf_put_var, nf_put_vara, nf_put_var1 这三个指令^为重要！
     
4.9     NF_GET_VAR1_type(ncid, varid, index(x), type_var)

    这个指令在取得某变量的『一PY料』，例如 rhval 这个三维Y料中，我要取得 rhval(4,3,2) 这个变量值，你可以这有矗
    -----
    integet  rhidx(3)
    data  rhidx  /4, 3, 2/
    statuse=nf_get_var1_double(ncid, RHID, rhidx, rhval)
    print *, rhval
    -----
     
4.10    NF_GET_VAR_type(ncid, varid, type_var(x))

    这个指令t是『取得某一变量的全部Y料』。其中 type_var(x) 是一个列樱
    -----
    status=nf_get_var_double(ncid, RHID, rhval)
    -----
     
4.11    NF_GET_VARA_type(ncid, varid, start(x), count(x), type_var(x))

    同拥模这个指令就是取得某一个列^域鹊谋淞抠Y料啦！用法与前面 nf_put_vara_type 相同哩！
     
4.12    NF_GET_VARS_type(ncid, varid, start(x), count(x), stride(x), type_var(x))

    这个也不用再f了吧！就是取得更小的列的Y料啦！
     
4.13    NF_RENAME_VAR(ncid, varid, 'newname')

    这个指令在更改一个变量的名Q，需要与 nf_redef, nf_inq_varid 配合写入，如下所示：
    -----
    status=open('netcdf.ncf', nf_write, ncid)
    status=nf_redef(ncid)
    status=nf_inq_varid(ncid, 'rh', RHID)
    status=nf_rename_var(ncid, RHID, 'rel_hum')
    status=nf_enddef_dim(ncid)
    -----


5. 建立与取得f明Y料

    你已建立好了一个 NetCDF 的文件了，但是你这个文件热莸氖粜曰]有的定义，这个说明部分就是所谓的 attributes 部分。为何要加入这一部分呢？这是因为我在前面的r候就已提到了， NetCDF 可以有很的文件属性f明，以避免文件的热荼晃笈校』本上 Models-3 e面的输出文件，都有很的f明文件头，另外，γ恳桓霰淞恳嗑加入了适当的f明，例如挝(moles/s)、长名(long name)等等。
     
5.1  NF_PUT_ATT_type(ncid, varid, 'name', xtype, len, type_var(x))

    同拥模与（MA四）中提到的相同， xtype 共分为六N类型：nf_byte, nf_char, nf_short, nf_int, nf_float, nf_double 等六N。而 type_var(x) 是一个列喔！例如我要 rh M行变量f明，f明的热菸 『valid_range』，而我o他的合理^g在 （0.0D0 ～ 100.0D0）t：
    -----
    double rhrange(2)
    data  rhrange  /0.0D0, 100.0D0/
    status=nf_put_att_double(ncid, RHID, 'valid_range', nf_double, 2, rhrange)
    -----
     
 5.2   NF_INQ_ATT(ncid, varid, 'name', xtype, len)

    {查 attributes 的n^f明，通常与 nf_inq_varid 配合使用。
    -----
    status=nf_inq_varid(1, 'rh', rhid)
    status=nf_inq_att(ncid, rhid, name, xtype, len)
    write(*,*), name, xtype, len
    -----
     
5.3    NF_GET_ATT_type(ncid, varid, 'name', type_var(x))

    取得 attribute 的热荩
    -----
    status=nf_get_att_double(ncid, rhid, 'balid_range', vrval)
    -----
     